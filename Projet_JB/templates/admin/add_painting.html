{% extends "base.html" %}

{% block title %}Ajouter une peinture - Admin{% endblock %}

{% block content %}

<!-- HEADER ADMIN -->
<header class="admin-header">
    <div class="admin-container">
        <h1>üé® Tableau de bord Admin</h1>
        <nav class="admin-nav">
            <a href="{{ url_for('admin_dashboard') }}" class="nav-btn {% if active=='dashboard' %}active{% endif %}">Dashboard</a>
            <a href="{{ url_for('admin_paintings') }}" class="nav-btn {% if active=='paintings' %}active{% endif %}">Peintures</a>
            <a href="{{ url_for('admin_orders') }}" class="nav-btn {% if active=='orders' %}active{% endif %}">Commandes</a>
            <a href="{{ url_for('admin_users') }}" class="nav-btn {% if active=='users' %}active{% endif %}">Utilisateurs</a>
            <a href="{{ url_for('admin_exhibitions') }}" class="nav-btn {% if active=='exhibitions' %}active{% endif %}">Exhibitions</a>
            <a href="{{ url_for('admin_notifications') }}" class="nav-btn {% if active=='notifications' %}active{% endif %}">
                üîî Notifications
                {% if new_notifications_count > 0 %}
                <span class="badge">{{ new_notifications_count }}</span>
                {% endif %}
            </a>
            <!-- Nouvel onglet Param√®tres -->
            <a href="{{ url_for('admin_settings_page') }}" class="nav-btn {% if active=='settings' %}active{% endif %}">‚öôÔ∏è Param√®tres</a>

            <a href="{{ url_for('add_painting_web') }}" class="nav-btn btn-primary">+ Ajouter</a>
        </nav>
    </div>
</header>


<!-- FORMULAIRE D'AJOUT -->
<section class="admin-section">
    <div class="admin-container">
        <div class="form-panel">
            <div class="form-header">
                <h2>Nouvelle peinture</h2>
                <a href="{{ url_for('admin_paintings') }}" class="btn-secondary">‚Üê Retour</a>
            </div>

            <form method="POST" enctype="multipart/form-data" class="admin-form">
                <div class="form-group">
                    <label for="name">Nom de l'≈ìuvre *</label>
                    <input type="text" id="name" name="name" placeholder="Ex: La Nuit √âtoil√©e" required>
                </div>

                <div class="form-group">
                    <label for="image">Image de la peinture *</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="image" name="image" accept="image/*" required onchange="previewImage(event)">
                        <span class="file-label">üìÅ Cliquez pour s√©lectionner une image</span>
                    </div>
                    <div id="preview-container" style="display: none;">
                        <img id="preview-image" src="" alt="Aper√ßu" class="preview-img">
                    </div>
                </div>

                <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" name="description" placeholder="D√©crivez la peinture..." rows="4"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="price">Prix (‚Ç¨) *</label>
                        <input type="number" id="price" name="price" placeholder="150" min="0" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label for="quantity">Quantit√© en stock *</label>
                        <input type="number" id="quantity" name="quantity" placeholder="5" min="0" required>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">üé® Ajouter la peinture</button>
                    <a href="{{ url_for('admin_paintings') }}" class="btn-secondary">Annuler</a>
                </div>
            </form>

            <div class="form-info">
                <h3>‚ÑπÔ∏è Informations</h3>
                <ul>
                    <li>Format accept√©s : JPG, PNG, GIF</li>
                    <li>Taille recommand√©e : minimum 300x300 pixels</li>
                    <li>Poids maximum : 5 MB</li>
                    <li>Tous les champs sont obligatoires sauf la description</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<script>
function previewImage(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const preview = document.getElementById('preview-image');
            const container = document.getElementById('preview-container');
            preview.src = e.target.result;
            container.style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const fileInput = document.getElementById('image');
    const wrapper = document.querySelector('.file-input-wrapper');
    
    if (wrapper) {
        wrapper.addEventListener('click', function() { fileInput.click(); });
        wrapper.addEventListener('dragover', function(e) { e.preventDefault(); wrapper.style.background = '#e0f2ff'; });
        wrapper.addEventListener('dragleave', function(e) { e.preventDefault(); wrapper.style.background = '#f9f9f9'; });
        wrapper.addEventListener('drop', function(e) {
            e.preventDefault();
            wrapper.style.background = '#f9f9f9';
            fileInput.files = e.dataTransfer.files;
            previewImage({target: fileInput});
        });
    }
});
</script>

{% endblock %}
